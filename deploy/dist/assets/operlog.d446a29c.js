import{z as K,r as p,B as Q,C as W,d as c,D,o as f,c as y,F as C,f as o,j as T,w as t,e,k,x as s,m as i,G as X,l as B,H as Y,s as Z}from"./index.095850b4.js";import{l as ee}from"./operlog.5701f034.js";const te={class:"app-container"},oe={key:0},ae={key:1},le={class:"dialog-footer"},ne=K({name:"Operlog"}),ue=Object.assign(ne,{setup(se){const{proxy:b}=Z(),{sys_oper_type:N,sys_common_status:P}=b.useDict("sys_oper_type","sys_common_status"),S=p([]),g=p(!1),v=p(!0);p(!0);const R=p([]);p(!0);const I=p(!0),w=p(0);p("");const q=p([]),z=p({prop:"operTime",order:"descending"}),L=Q({form:{},queryParams:{pageNum:1,pageSize:10,title:void 0,operName:void 0,businessType:void 0,status:void 0}}),{queryParams:m,form:a}=W(L);function h(){v.value=!0,ee(b.addDateRange(m.value,q.value)).then(n=>{S.value=n.rows,w.value=n.total,v.value=!1})}function U(n,r){return b.selectDictLabel(N.value,n.businessType)}function j(n){R.value=n.map(r=>r.operId),I.value=!n.length}function F(n,r,d){m.value.orderByColumn=n.prop,m.value.isAsc=n.order,h()}function M(n){g.value=!0,a.value=n}return h(),(n,r)=>{const d=c("el-table-column"),V=c("dict-tag"),x=c("el-button"),O=c("el-table"),$=c("pagination"),u=c("el-form-item"),_=c("el-col"),A=c("el-row"),E=c("el-form"),G=c("el-dialog"),H=D("hasPermi"),J=D("loading");return f(),y("div",te,[C((f(),T(O,{ref:"operlogRef",data:o(S),onSelectionChange:j,"default-sort":o(z),onSortChange:F},{default:t(()=>[e(d,{type:"selection",width:"50",align:"center"}),e(d,{label:"\u65E5\u5FD7\u7F16\u53F7",align:"center",prop:"operId"}),e(d,{label:"\u7CFB\u7EDF\u6A21\u5757",align:"center",prop:"title","show-overflow-tooltip":!0}),e(d,{label:"\u64CD\u4F5C\u7C7B\u578B",align:"center",prop:"businessType"},{default:t(l=>[e(V,{options:o(N),value:l.row.businessType},null,8,["options","value"])]),_:1}),e(d,{label:"\u64CD\u4F5C\u4EBA\u5458",align:"center",width:"110",prop:"operName","show-overflow-tooltip":!0,sortable:"custom","sort-orders":["descending","ascending"]}),e(d,{label:"\u4E3B\u673A",align:"center",prop:"operIp",width:"130","show-overflow-tooltip":!0}),e(d,{label:"\u64CD\u4F5C\u72B6\u6001",align:"center",prop:"status"},{default:t(l=>[e(V,{options:o(P),value:l.row.status},null,8,["options","value"])]),_:1}),e(d,{label:"\u64CD\u4F5C\u65E5\u671F",align:"center",prop:"operTime",width:"180",sortable:"custom","sort-orders":["descending","ascending"]},{default:t(l=>[k("span",null,s(n.parseTime(l.row.operTime)),1)]),_:1}),e(d,{label:"\u6D88\u8017\u65F6\u95F4",align:"center",prop:"costTime",width:"110","show-overflow-tooltip":!0,sortable:"custom","sort-orders":["descending","ascending"]},{default:t(l=>[k("span",null,s(l.row.costTime)+"\u6BEB\u79D2",1)]),_:1}),e(d,{label:"\u64CD\u4F5C",align:"center","class-name":"small-padding fixed-width"},{default:t(l=>[C((f(),T(x,{link:"",type:"primary",icon:"View",onClick:re=>M(l.row,l.index)},{default:t(()=>[i("\u8BE6\u7EC6")]),_:2},1032,["onClick"])),[[H,["monitor:operlog:query"]]])]),_:1})]),_:1},8,["data","default-sort"])),[[J,o(v)]]),C(e($,{total:o(w),page:o(m).pageNum,"onUpdate:page":r[0]||(r[0]=l=>o(m).pageNum=l),limit:o(m).pageSize,"onUpdate:limit":r[1]||(r[1]=l=>o(m).pageSize=l),onPagination:h},null,8,["total","page","limit"]),[[X,o(w)>0]]),e(G,{title:"\u64CD\u4F5C\u65E5\u5FD7\u8BE6\u7EC6",modelValue:o(g),"onUpdate:modelValue":r[3]||(r[3]=l=>Y(g)?g.value=l:null),width:"700px","append-to-body":""},{footer:t(()=>[k("div",le,[e(x,{onClick:r[2]||(r[2]=l=>g.value=!1)},{default:t(()=>[i("\u5173 \u95ED")]),_:1})])]),default:t(()=>[e(E,{model:o(a),"label-width":"100px"},{default:t(()=>[e(A,null,{default:t(()=>[e(_,{span:12},{default:t(()=>[e(u,{label:"\u64CD\u4F5C\u6A21\u5757\uFF1A"},{default:t(()=>[i(s(o(a).title)+" / "+s(U(o(a))),1)]),_:1}),e(u,{label:"\u767B\u5F55\u4FE1\u606F\uFF1A"},{default:t(()=>[i(s(o(a).operName)+" / "+s(o(a).operIp)+" / "+s(o(a).operLocation),1)]),_:1})]),_:1}),e(_,{span:12},{default:t(()=>[e(u,{label:"\u8BF7\u6C42\u5730\u5740\uFF1A"},{default:t(()=>[i(s(o(a).operUrl),1)]),_:1}),e(u,{label:"\u8BF7\u6C42\u65B9\u5F0F\uFF1A"},{default:t(()=>[i(s(o(a).requestMethod),1)]),_:1})]),_:1}),e(_,{span:24},{default:t(()=>[e(u,{label:"\u64CD\u4F5C\u65B9\u6CD5\uFF1A"},{default:t(()=>[i(s(o(a).method),1)]),_:1})]),_:1}),e(_,{span:24},{default:t(()=>[e(u,{label:"\u8BF7\u6C42\u53C2\u6570\uFF1A"},{default:t(()=>[i(s(o(a).operParam),1)]),_:1})]),_:1}),e(_,{span:24},{default:t(()=>[e(u,{label:"\u8FD4\u56DE\u53C2\u6570\uFF1A"},{default:t(()=>[i(s(o(a).jsonResult),1)]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(u,{label:"\u64CD\u4F5C\u72B6\u6001\uFF1A"},{default:t(()=>[o(a).status===0?(f(),y("div",oe,"\u6B63\u5E38")):o(a).status===1?(f(),y("div",ae,"\u5931\u8D25")):B("",!0)]),_:1})]),_:1}),e(_,{span:8},{default:t(()=>[e(u,{label:"\u6D88\u8017\u65F6\u95F4\uFF1A"},{default:t(()=>[i(s(o(a).costTime)+"\u6BEB\u79D2",1)]),_:1})]),_:1}),e(_,{span:10},{default:t(()=>[e(u,{label:"\u64CD\u4F5C\u65F6\u95F4\uFF1A"},{default:t(()=>[i(s(n.parseTime(o(a).operTime)),1)]),_:1})]),_:1}),e(_,{span:24},{default:t(()=>[o(a).status===1?(f(),T(u,{key:0,label:"\u5F02\u5E38\u4FE1\u606F\uFF1A"},{default:t(()=>[i(s(o(a).errorMsg),1)]),_:1})):B("",!0)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});export{ue as default};
