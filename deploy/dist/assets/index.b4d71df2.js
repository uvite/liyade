import{H as w,K as _e,z as ge,r as s,A as ve,B as be,d as p,C as G,o as d,c as N,D as b,F as H,f as t,e as l,w as a,i as T,M as B,N as E,j as _,m as g,G as J,k as W,x as ye,s as Ve}from"./index.ba7644a6.js";function Ce(m){return w({url:"/app/product/list",method:"get",params:m})}function X(m){return w({url:"/app/product/"+_e(m),method:"get"})}function he(m){return w({url:"/app/product",method:"post",data:m})}function ke(m){return w({url:"/app/product",method:"put",data:m})}function we(m){return w({url:"/app/product/"+m,method:"delete"})}const xe={class:"app-container"},Se={class:"dialog-footer"},Pe=ge({name:"Product"}),Te=Object.assign(Pe,{setup(m){const{proxy:v}=Ve(),{product_type:I}=v.useDict("product_type"),U=s([]),F=s([]),y=s(!1),D=s(!0),x=s(!0),S=s([]),z=s(!0),L=s(!0),K=s(0),q=s(""),Q=s(0);function Y(){Q.value=u.value.remark.length}const Z=ve({form:{},queryParams:{pageNum:1,pageSize:20,productName:null,productType:null,productAlias:null,productSupplierCode:null,productCode:null,productPrice:null,productCreateTime:null},rules:{productName:[{required:!0,trigger:"blur",max:200,message:"\u4EA7\u54C1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],productCode:[{required:!0,trigger:"blur",max:200,message:"\u4EA7\u54C1\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A"}],productType:[{required:!0,trigger:"blur",max:10,message:"\u4EA7\u54C1\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A"}],productAlias:[{required:!0,trigger:"blur",max:200,message:"\u4EA7\u54C1\u522B\u540D\u4E0D\u80FD\u4E3A\u7A7A"}]}}),{queryParams:r,form:u,rules:ee}=be(Z);function C(){D.value=!0,Ce(r.value).then(n=>{F.value=n.rows,K.value=n.total,D.value=!1})}function le(){y.value=!1,A()}function A(){u.value={productId:null,productName:null,productType:null,productSupplierCode:null,productCode:null,productPrice:null,productCreateTime:null,createBy:null,createTime:null,updateBy:null,updateTime:null,remark:null},v.resetForm("productRef")}function h(){r.value.pageNum=1,C()}function te(){v.resetForm("queryRef"),h()}function oe(n){S.value=n.map(o=>o.productId),z.value=n.length!=1,L.value=!n.length}function ae(){A(),X().then(n=>{U.value=n.suppliers,y.value=!0,q.value="\u6DFB\u52A0\u4EA7\u54C1\u7BA1\u7406"})}async function j(n){A();const o=n.productId||S.value;X(o).then(async c=>{U.value=c.suppliers,u.value=c.data,u.value.supplierId=parseInt(c.data.supplierId),y.value=!0,q.value="\u4FEE\u6539\u4EA7\u54C1\u7BA1\u7406"})}function ue(){v.$refs.productRef.validate(n=>{n&&(u.value.productId!=null?ke(u.value).then(o=>{v.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),y.value=!1,C()}):he(u.value).then(o=>{v.$modal.msgSuccess("\u65B0\u589E\u6210\u529F"),y.value=!1,C()}))})}function M(n){n.productId&&(S.value=[n.productId]);const o=S.value;v.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664"'+o.length+'"\u6761\u4EA7\u54C1\u7684\u6570\u636E\u9879\uFF1F').then(function(){return we(o)}).then(()=>{C(),v.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}function re(){v.download("app/product/export",{...r.value},`product_${new Date().getTime()}.xlsx`)}return C(),(n,o)=>{const c=p("el-input"),i=p("el-form-item"),R=p("el-option"),$=p("el-select"),f=p("el-button"),O=p("el-form"),P=p("el-col"),ne=p("right-toolbar"),pe=p("el-row"),V=p("el-table-column"),de=p("dict-tag"),ce=p("el-table"),ie=p("pagination"),se=p("el-dialog"),k=G("hasPermi"),me=G("loading");return d(),N("div",xe,[b(l(O,{model:t(r),ref:"queryRef",inline:!0,"label-width":"68px"},{default:a(()=>[l(i,{label:"\u540D\u79F0",prop:"productName"},{default:a(()=>[l(c,{modelValue:t(r).productName,"onUpdate:modelValue":o[0]||(o[0]=e=>t(r).productName=e),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",clearable:"",onKeyup:T(h,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(i,{label:`\u7C7B\u578B\r
`,prop:"productType"},{default:a(()=>[l($,{modelValue:t(r).productType,"onUpdate:modelValue":o[1]||(o[1]=e=>t(r).productType=e),placeholder:`\u8BF7\u9009\u62E9\u7C7B\u578B\r
`,clearable:""},{default:a(()=>[(d(!0),N(B,null,E(t(I),e=>(d(),_(R,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,{label:`\u4F9B\u5E94\u5546\r
`,prop:"productSupplierCode"},{default:a(()=>[l(c,{modelValue:t(r).productSupplierCode,"onUpdate:modelValue":o[2]||(o[2]=e=>t(r).productSupplierCode=e),placeholder:`\u8BF7\u8F93\u5165\u4F9B\u5E94\u5546\r
`,clearable:"",onKeyup:T(h,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(i,{label:`\u4EA7\u54C1\u7F16\u53F7\r
`,prop:"productCode"},{default:a(()=>[l(c,{modelValue:t(r).productCode,"onUpdate:modelValue":o[3]||(o[3]=e=>t(r).productCode=e),placeholder:`\u8BF7\u8F93\u5165\u4EA7\u54C1\u7F16\u53F7\r
`,clearable:"",onKeyup:T(h,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(i,{label:"\u53C2\u8003\u4EF7\u683C",prop:"productPrice"},{default:a(()=>[l(c,{modelValue:t(r).productPrice,"onUpdate:modelValue":o[4]||(o[4]=e=>t(r).productPrice=e),placeholder:"\u8BF7\u8F93\u5165\u53C2\u8003\u4EF7\u683C",clearable:"",onKeyup:T(h,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(i,null,{default:a(()=>[l(f,{type:"primary",icon:"Search",onClick:h},{default:a(()=>[g("\u641C\u7D22")]),_:1}),l(f,{icon:"Refresh",onClick:te},{default:a(()=>[g("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[H,t(x)]]),l(pe,{gutter:10,class:"mb8"},{default:a(()=>[l(P,{span:1.5},{default:a(()=>[b((d(),_(f,{type:"primary",plain:"",icon:"Plus",onClick:ae},{default:a(()=>[g("\u65B0\u589E ")]),_:1})),[[k,["app:product:add"]]])]),_:1},8,["span"]),l(P,{span:1.5},{default:a(()=>[b((d(),_(f,{type:"success",plain:"",icon:"Edit",disabled:t(z),onClick:j},{default:a(()=>[g("\u4FEE\u6539 ")]),_:1},8,["disabled"])),[[k,["app:product:edit"]]])]),_:1},8,["span"]),l(P,{span:1.5},{default:a(()=>[b((d(),_(f,{type:"danger",plain:"",icon:"Delete",disabled:t(L),onClick:M},{default:a(()=>[g("\u5220\u9664 ")]),_:1},8,["disabled"])),[[k,["app:product:remove"]]])]),_:1},8,["span"]),l(P,{span:1.5},{default:a(()=>[b((d(),_(f,{type:"warning",plain:"",icon:"Download",onClick:re},{default:a(()=>[g("\u5BFC\u51FA ")]),_:1})),[[k,["app:product:export"]]])]),_:1},8,["span"]),l(ne,{showSearch:t(x),"onUpdate:showSearch":o[5]||(o[5]=e=>J(x)?x.value=e:null),onQueryTable:C},null,8,["showSearch"])]),_:1}),b((d(),_(ce,{data:t(F),onSelectionChange:oe},{default:a(()=>[l(V,{type:"selection",width:"55",align:"center"}),l(V,{label:"\u4EA7\u54C1\u540D\u79F0",align:"center",prop:"productName"}),l(V,{label:"\u4EA7\u54C1\u522B\u540D",align:"center",prop:"productAlias"}),l(V,{label:"\u4EA7\u54C1\u7F16\u53F7",align:"center",prop:"productCode"}),l(V,{label:"\u53C2\u8003\u4EF7\u683C",align:"center",prop:"productPrice"}),l(V,{label:"\u4F9B\u5E94\u5546",align:"center",prop:"supplier.supplierName"}),l(V,{label:"\u7C7B\u578B",align:"center",prop:"productType"},{default:a(e=>[l(de,{options:t(I),value:e.row.productType},null,8,["options","value"])]),_:1}),l(V,{label:"\u64CD\u4F5C",align:"center","class-name":"small-padding fixed-width"},{default:a(e=>[b((d(),_(f,{link:"",type:"primary",icon:"Edit",onClick:fe=>j(e.row)},{default:a(()=>[g(" \u4FEE\u6539 ")]),_:2},1032,["onClick"])),[[k,["app:product:edit"]]]),b((d(),_(f,{link:"",type:"primary",icon:"Delete",onClick:fe=>M(e.row)},{default:a(()=>[g("\u5220\u9664 ")]),_:2},1032,["onClick"])),[[k,["app:product:remove"]]])]),_:1})]),_:1},8,["data"])),[[me,t(D)]]),b(l(ie,{total:t(K),page:t(r).pageNum,"onUpdate:page":o[6]||(o[6]=e=>t(r).pageNum=e),limit:t(r).pageSize,"onUpdate:limit":o[7]||(o[7]=e=>t(r).pageSize=e),onPagination:C},null,8,["total","page","limit"]),[[H,t(K)>0]]),l(se,{title:t(q),modelValue:t(y),"onUpdate:modelValue":o[15]||(o[15]=e=>J(y)?y.value=e:null),width:"500px","append-to-body":""},{footer:a(()=>[W("div",Se,[l(f,{type:"primary",onClick:ue},{default:a(()=>[g("\u786E \u5B9A")]),_:1}),l(f,{onClick:le},{default:a(()=>[g("\u53D6 \u6D88")]),_:1})])]),default:a(()=>[l(O,{ref:"productRef",model:t(u),rules:t(ee),"label-width":"80px"},{default:a(()=>[l(i,{label:"\u540D\u79F0",prop:"productName"},{default:a(()=>[l(c,{modelValue:t(u).productName,"onUpdate:modelValue":o[8]||(o[8]=e=>t(u).productName=e),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u7C7B\u578B",prop:"productType"},{default:a(()=>[l($,{modelValue:t(u).productType,"onUpdate:modelValue":o[9]||(o[9]=e=>t(u).productType=e),placeholder:`\u8BF7\u9009\u62E9\u7C7B\u578B\r
`},{default:a(()=>[(d(!0),N(B,null,E(t(I),e=>(d(),_(R,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"\u4F9B\u5E94\u5546",prop:"productSupplierCode"},{default:a(()=>[l($,{modelValue:t(u).supplierId,"onUpdate:modelValue":o[10]||(o[10]=e=>t(u).supplierId=e),placeholder:"\u8BF7\u9009\u62E9"},{default:a(()=>[(d(!0),N(B,null,E(t(U),e=>(d(),_(R,{key:e.supplierId,label:e.supplierName,value:e.supplierId,disabled:e.status==1},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"\u4EA7\u54C1\u7F16\u53F7",prop:"productCode"},{default:a(()=>[l(c,{modelValue:t(u).productCode,"onUpdate:modelValue":o[11]||(o[11]=e=>t(u).productCode=e),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u7F16\u53F7"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u4EA7\u54C1\u522B\u540D",prop:"productAlias"},{default:a(()=>[l(c,{modelValue:t(u).productAlias,"onUpdate:modelValue":o[12]||(o[12]=e=>t(u).productAlias=e),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u522B\u540D"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u53C2\u8003\u4EF7\u683C",prop:"productPrice"},{default:a(()=>[l(c,{modelValue:t(u).productPrice,"onUpdate:modelValue":o[13]||(o[13]=e=>t(u).productPrice=e),placeholder:"\u8BF7\u8F93\u5165\u53C2\u8003\u4EF7\u683C"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u5907\u6CE8",prop:"remark"},{default:a(()=>[l(c,{modelValue:t(u).remark,"onUpdate:modelValue":o[14]||(o[14]=e=>t(u).remark=e),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",maxlength:"200",onInput:Y},null,8,["modelValue"]),W("span",null,ye(t(Q))+"/200",1)]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Te as default};
