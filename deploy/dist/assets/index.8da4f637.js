import{A as w,z as be,r as v,B as _e,C as ve,d as s,D as A,o as f,c as $,F as S,G,f as t,e as l,w as n,i as k,m as b,j as y,H,k as L,x as M,M as O,N as J,s as Ve}from"./index.095850b4.js";function ge(m){return w({url:"/app/licenses/list",method:"get",params:m})}function ye(m){return w({url:"/app/licenses/"+m,method:"get"})}function he(m){return w({url:"/app/licenses",method:"post",data:m})}function Ue(m){return w({url:"/app/licenses",method:"put",data:m})}function Se(m,r){return w({url:"/app/licenses/changeStatus",method:"put",data:{licenseId:m,used:r}})}function ke(m,r){return w({url:"/app/licenses/changeStatus",method:"put",data:{licenseId:m,enabled:r}})}const we={class:"app-container"},je={class:"dialog-footer"},Ce=be({name:"Licenses"}),Me=Object.assign(Ce,{setup(m){const{proxy:r}=Ve(),{license_used:N}=r.useDict("license_used"),{license_enabled:W}=r.useDict("license_enabled"),R=v([]),V=v(!1),Y=v(!0),j=v(!0),B=v([]),P=v(!0),X=v(!0),D=v(0),E=v(""),Z=_e({form:{},queryParams:{pageNum:1,pageSize:10,deviceId:null,used:null,enabled:null,limitStart:null,limitEnd:null},rules:{}}),{queryParams:u,form:d,rules:ee}=ve(Z);function U(){Y.value=!0,ge(u.value).then(o=>{R.value=o.rows,D.value=o.total,Y.value=!1})}function le(){V.value=!1,K()}function K(){d.value={licenseId:null,deviceId:null,used:null,enabled:null,limitStart:null,limitEnd:null,createBy:null,createTime:null,updateBy:null,updateTime:null,remark:null},r.resetForm("licensesRef")}function g(){u.value.pageNum=1,U()}function ae(){r.resetForm("queryRef"),g()}function te(o){B.value=o.map(a=>a.licenseId),P.value=o.length!=1,X.value=!o.length}function ne(){K(),V.value=!0,d.value.used="0",d.value.enabled="0",E.value="\u6DFB\u52A0\u6388\u6743\u7BA1\u7406"}function T(o){K();const a=o.id||B.value;ye(a).then(p=>{d.value=p.data,V.value=!0,E.value="\u4FEE\u6539\u6388\u6743\u7BA1\u7406"})}function oe(){r.$refs.licensesRef.validate(o=>{o&&(d.value.id!=null?Ue(d.value).then(a=>{r.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),V.value=!1,U()}):he(d.value).then(a=>{r.$modal.msgSuccess("\u65B0\u589E\u6210\u529F"),V.value=!1,U()}))})}function de(o){r.download("app/licenses/file/download/"+o.licenseId,{...u.value},`licenses_${o.fileName}.txt`)}function ue(o){let a=o.used==="0"?"\u542F\u7528":"\u505C\u7528";r.$modal.confirm('\u786E\u8BA4\u8981"'+a+'""'+o.deviceId+'"\u8BBE\u5907?').then(function(){return Se(o.licenseId,o.used)}).then(()=>{r.$modal.msgSuccess(a+"\u6210\u529F")}).catch(function(){o.used=o.used==="0"?"1":"0"})}function ie(o){let a=o.enabled==="0"?"\u5BA1\u6838":"\u53CD\u5BA1";r.$modal.confirm('\u786E\u8BA4\u8981"'+a+'""'+o.deviceId+'"\u8BBE\u5907?').then(function(){return ke(o.licenseId,o.enabled)}).then(()=>{r.$modal.msgSuccess(a+"\u6210\u529F")}).catch(function(){o.enabled=o.enabled==="0"?"1":"0"})}return U(),(o,a)=>{const p=s("el-input"),i=s("el-form-item"),C=s("el-date-picker"),_=s("el-button"),F=s("el-form"),I=s("el-col"),re=s("right-toolbar"),se=s("el-row"),c=s("el-table-column"),q=s("el-switch"),pe=s("el-table"),me=s("pagination"),z=s("el-radio"),Q=s("el-radio-group"),ce=s("el-dialog"),x=A("hasPermi"),fe=A("loading");return f(),$("div",we,[S(l(F,{model:t(u),ref:"queryRef",inline:!0,"label-width":"68px"},{default:n(()=>[l(i,{label:"\u8BBE\u5907id",prop:"deviceId"},{default:n(()=>[l(p,{modelValue:t(u).deviceId,"onUpdate:modelValue":a[0]||(a[0]=e=>t(u).deviceId=e),placeholder:"\u8BF7\u8F93\u5165\u8BBE\u5907id",clearable:"",onKeyup:k(g,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(i,{label:"\u662F\u5426\u4F7F\u7528",prop:"used"},{default:n(()=>[l(p,{modelValue:t(u).used,"onUpdate:modelValue":a[1]||(a[1]=e=>t(u).used=e),placeholder:"\u8BF7\u8F93\u5165\u662F\u5426\u4F7F\u7528",clearable:"",onKeyup:k(g,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(i,{label:"\u72B6\u6001",prop:"enabled"},{default:n(()=>[l(p,{modelValue:t(u).enabled,"onUpdate:modelValue":a[2]||(a[2]=e=>t(u).enabled=e),placeholder:"\u8BF7\u8F93\u5165\u72B6\u6001",clearable:"",onKeyup:k(g,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(i,{label:"\u66F4\u65B0\u65F6\u95F4",prop:"limitStart"},{default:n(()=>[l(C,{clearable:"",modelValue:t(u).limitStart,"onUpdate:modelValue":a[3]||(a[3]=e=>t(u).limitStart=e),type:"date","value-format":"YYYY-MM-DD",placeholder:"\u8BF7\u9009\u62E9\u66F4\u65B0\u65F6\u95F4"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u66F4\u65B0\u65F6\u95F4",prop:"limitEnd"},{default:n(()=>[l(C,{clearable:"",modelValue:t(u).limitEnd,"onUpdate:modelValue":a[4]||(a[4]=e=>t(u).limitEnd=e),type:"date","value-format":"YYYY-MM-DD",placeholder:"\u8BF7\u9009\u62E9\u66F4\u65B0\u65F6\u95F4"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u9879\u76EE\u540D\u79F0",prop:"projectName"},{default:n(()=>[l(p,{modelValue:t(u).projectName,"onUpdate:modelValue":a[5]||(a[5]=e=>t(u).projectName=e),placeholder:"\u8BF7\u8F93\u5165\u9879\u76EE\u540D\u79F0",clearable:"",onKeyup:k(g,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(i,{label:"\u8054\u7CFB\u4EBA\u59D3\u540D",prop:"projectUsername"},{default:n(()=>[l(p,{modelValue:t(u).projectUsername,"onUpdate:modelValue":a[6]||(a[6]=e=>t(u).projectUsername=e),placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u4EBA\u59D3\u540D",clearable:"",onKeyup:k(g,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(i,{label:"\u8054\u7CFB\u4EBA\u7535\u8BDD",prop:"projectMobile"},{default:n(()=>[l(p,{modelValue:t(u).projectMobile,"onUpdate:modelValue":a[7]||(a[7]=e=>t(u).projectMobile=e),placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u4EBA\u7535\u8BDD",clearable:"",onKeyup:k(g,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(i,null,{default:n(()=>[l(_,{type:"primary",icon:"Search",onClick:g},{default:n(()=>[b("\u641C\u7D22")]),_:1}),l(_,{icon:"Refresh",onClick:ae},{default:n(()=>[b("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[G,t(j)]]),l(se,{gutter:10,class:"mb8"},{default:n(()=>[l(I,{span:1.5},{default:n(()=>[S((f(),y(_,{type:"primary",plain:"",icon:"Plus",onClick:ne},{default:n(()=>[b("\u65B0\u589E")]),_:1})),[[x,["app:licenses:add"]]])]),_:1},8,["span"]),l(I,{span:1.5},{default:n(()=>[S((f(),y(_,{type:"success",plain:"",icon:"Edit",disabled:t(P),onClick:T},{default:n(()=>[b("\u4FEE\u6539")]),_:1},8,["disabled"])),[[x,["app:licenses:edit"]]])]),_:1},8,["span"]),l(I,{span:1.5},null,8,["span"]),l(I,{span:1.5},null,8,["span"]),l(re,{showSearch:t(j),"onUpdate:showSearch":a[8]||(a[8]=e=>H(j)?j.value=e:null),onQueryTable:U},null,8,["showSearch"])]),_:1}),S((f(),y(pe,{data:t(R),onSelectionChange:te},{default:n(()=>[l(c,{type:"selection",width:"55",align:"center"}),l(c,{label:"License Id",align:"center",prop:"licenseId"}),l(c,{label:"\u8BBE\u5907Id",align:"center",prop:"deviceId"}),l(c,{label:"\u662F\u5426\u4F7F\u7528",align:"center"},{default:n(e=>[l(q,{modelValue:e.row.used,"onUpdate:modelValue":h=>e.row.used=h,"active-value":"1","inactive-value":"0",onChange:h=>ue(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(c,{label:"\u662F\u5426\u5BA1\u6838",align:"center"},{default:n(e=>[l(q,{modelValue:e.row.enabled,"onUpdate:modelValue":h=>e.row.enabled=h,"active-value":"1","inactive-value":"0",onChange:h=>ie(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(c,{label:"\u9879\u76EE\u540D\u79F0",align:"center",prop:"projectName"}),l(c,{label:"\u8054\u7CFB\u4EBA\u59D3\u540D",align:"center",prop:"projectUsername"}),l(c,{label:"\u8054\u7CFB\u4EBA\u7535\u8BDD",align:"center",prop:"projectMobile"}),l(c,{label:"\u5F00\u59CB\u65F6\u95F4",align:"center",prop:"limitStart",width:"180"},{default:n(e=>[L("span",null,M(o.parseTime(e.row.limitStart,"{y}-{m}-{d}")),1)]),_:1}),l(c,{label:"\u622A\u81F3\u65F6\u95F4",align:"center",prop:"limitEnd",width:"180"},{default:n(e=>[L("span",null,M(o.parseTime(e.row.limitEnd,"{y}-{m}-{d}")),1)]),_:1}),l(c,{label:"\u4E0B\u8F7D",align:"center",prop:"limitStart",width:"180"},{default:n(e=>[e.row.enabled==1?(f(),y(_,{key:0,link:"",type:"primary",icon:"Download",onClick:h=>de(e.row)},{default:n(()=>[b("\u4E0B\u8F7D")]),_:2},1032,["onClick"])):(f(),y(_,{key:1},{default:n(()=>[b("\u5BA1\u6838\u540E\u4E0B\u8F7D")]),_:1}))]),_:1}),l(c,{label:"\u64CD\u4F5C",align:"center","class-name":"small-padding fixed-width"},{default:n(e=>[S((f(),y(_,{link:"",type:"primary",icon:"Edit",onClick:h=>T(e.row)},{default:n(()=>[b("\u4FEE\u6539")]),_:2},1032,["onClick"])),[[x,["app:licenses:edit"]]])]),_:1})]),_:1},8,["data"])),[[fe,t(Y)]]),S(l(me,{total:t(D),page:t(u).pageNum,"onUpdate:page":a[9]||(a[9]=e=>t(u).pageNum=e),limit:t(u).pageSize,"onUpdate:limit":a[10]||(a[10]=e=>t(u).pageSize=e),onPagination:U},null,8,["total","page","limit"]),[[G,t(D)>0]]),l(ce,{title:t(E),modelValue:t(V),"onUpdate:modelValue":a[20]||(a[20]=e=>H(V)?V.value=e:null),width:"500px","append-to-body":""},{footer:n(()=>[L("div",je,[l(_,{type:"primary",onClick:oe},{default:n(()=>[b("\u786E \u5B9A")]),_:1}),l(_,{onClick:le},{default:n(()=>[b("\u53D6 \u6D88")]),_:1})])]),default:n(()=>[l(F,{ref:"licensesRef",model:t(d),rules:t(ee),"label-width":"80px"},{default:n(()=>[l(i,{label:"\u8BBE\u5907Id",prop:"deviceId"},{default:n(()=>[l(p,{modelValue:t(d).deviceId,"onUpdate:modelValue":a[11]||(a[11]=e=>t(d).deviceId=e),placeholder:"\u8BF7\u8F93\u5165\u8BBE\u5907Id"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u4F7F\u7528\u60C5\u51B5"},{default:n(()=>[l(Q,{modelValue:t(d).used,"onUpdate:modelValue":a[12]||(a[12]=e=>t(d).used=e)},{default:n(()=>[(f(!0),$(O,null,J(t(N),e=>(f(),y(z,{key:e.value,label:e.value},{default:n(()=>[b(M(e.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"\u5BA1\u6838\u60C5\u51B5"},{default:n(()=>[l(Q,{modelValue:t(d).enabled,"onUpdate:modelValue":a[13]||(a[13]=e=>t(d).enabled=e)},{default:n(()=>[(f(!0),$(O,null,J(t(W),e=>(f(),y(z,{key:e.value,label:e.value},{default:n(()=>[b(M(e.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"\u9879\u76EE\u540D\u79F0",prop:"projectName"},{default:n(()=>[l(p,{modelValue:t(d).projectName,"onUpdate:modelValue":a[14]||(a[14]=e=>t(d).projectName=e),placeholder:"\u8BF7\u8F93\u5165\u9879\u76EE\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u8054\u7CFB\u4EBA\u59D3\u540D",prop:"projectUsername"},{default:n(()=>[l(p,{modelValue:t(d).projectUsername,"onUpdate:modelValue":a[15]||(a[15]=e=>t(d).projectUsername=e),placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u4EBA\u59D3\u540D"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u8054\u7CFB\u4EBA\u7535\u8BDD",prop:"projectMobile"},{default:n(()=>[l(p,{modelValue:t(d).projectMobile,"onUpdate:modelValue":a[16]||(a[16]=e=>t(d).projectMobile=e),placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u4EBA\u7535\u8BDD"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u66F4\u65B0\u65F6\u95F4",prop:"limitStart"},{default:n(()=>[l(C,{clearable:"",modelValue:t(d).limitStart,"onUpdate:modelValue":a[17]||(a[17]=e=>t(d).limitStart=e),type:"date","value-format":"YYYY-MM-DD",placeholder:"\u8BF7\u9009\u62E9\u66F4\u65B0\u65F6\u95F4"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u66F4\u65B0\u65F6\u95F4",prop:"limitEnd"},{default:n(()=>[l(C,{clearable:"",modelValue:t(d).limitEnd,"onUpdate:modelValue":a[18]||(a[18]=e=>t(d).limitEnd=e),type:"date","value-format":"YYYY-MM-DD",placeholder:"\u8BF7\u9009\u62E9\u66F4\u65B0\u65F6\u95F4"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u5907\u6CE8",prop:"remark"},{default:n(()=>[l(p,{modelValue:t(d).remark,"onUpdate:modelValue":a[19]||(a[19]=e=>t(d).remark=e),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Me as default};
