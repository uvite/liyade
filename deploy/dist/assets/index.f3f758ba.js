import{A as D,K as ke,z as be,r as v,B as Se,C as ye,d as r,D as X,o as n,c as I,F as S,G as Z,f as t,e as l,w as o,M as C,N as B,j as c,i as M,m as k,H as ee,k as q,x as le,s as ge}from"./index.90b8d4fb.js";function Ve(m){return D({url:"/app/device/list",method:"get",params:m})}function z(m){return D({url:"/app/device/"+ke(m),method:"get"})}function Ie(m){return D({url:"/app/device",method:"post",data:m})}function he(m){return D({url:"/app/device",method:"put",data:m})}function we(m){return D({url:"/app/device/"+m,method:"delete"})}const Ce={class:"app-container"},Be={class:"dialog-footer"},Te=be({name:"Device"}),Oe=Object.assign(Te,{setup(m){const{proxy:b}=ge(),{device_status:K,stock_status:R,product_type:De}=b.useDict("device_status","stock_status","product_type"),U=v([]),O=v([]),L=v([]),y=v(!1),Y=v(!0),x=v(!0),$=v([]),Q=v(!0),j=v(!0),P=v(0),E=v(""),te=Se({form:{},queryParams:{pageNum:1,pageSize:10,productId:null,supplierId:null,deviceStatus:null,deviceCode:null,deviceInStockBy:null,deviceInStockTime:null,deviceOutStockBy:null,deviceOutStockTime:null,stockStatus:null},rules:{}}),{queryParams:i,form:u,rules:ae}=ye(te);function g(){Y.value=!0,Ve(i.value).then(d=>{L.value=d.rows,P.value=d.total,Y.value=!1}),z().then(d=>{O.value=d.suppliers,U.value=d.products})}function oe(){y.value=!1,F()}function F(){u.value={deviceId:null,productId:null,supplierId:null,deviceStatus:null,deviceCode:null,createBy:null,createTime:null,updateBy:null,updateTime:null,remark:null,deviceInStockBy:null,deviceInStockTime:null,deviceOutStockBy:null,deviceOutStockTime:null,stockStatus:null,deleteBy:null,deleteTime:null,isDeleted:null},b.resetForm("deviceRef")}function T(){i.value.pageNum=1,g()}function ue(){b.resetForm("queryRef"),T()}function de(d){$.value=d.map(a=>a.deviceId),Q.value=d.length!=1,j.value=!d.length}function ne(){F(),z().then(d=>{O.value=d.suppliers,U.value=d.products,y.value=!0,E.value="\u6DFB\u52A0\u8BBE\u5907\u7BA1\u7406"})}function A(d){F();const a=d.deviceId||$.value;z(a).then(s=>{O.value=s.suppliers,U.value=s.products,u.value=s.data,u.value.productId=parseInt(s.data.productId),u.value.supplierId=parseInt(s.data.supplierId),y.value=!0,E.value="\u4FEE\u6539\u8BBE\u5907\u7BA1\u7406"})}function ie(){b.$refs.deviceRef.validate(d=>{d&&(u.value.deviceId!=null?he(u.value).then(a=>{b.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),y.value=!1,g()}):Ie(u.value).then(a=>{b.$modal.msgSuccess("\u65B0\u589E\u6210\u529F"),y.value=!1,g()}))})}function G(d){const a=d.deviceId||$.value;b.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u8BBE\u5907\u7BA1\u7406\u7F16\u53F7\u4E3A"'+a+'"\u7684\u6570\u636E\u9879\uFF1F').then(function(){return we(a)}).then(()=>{g(),b.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}function pe(){b.download("app/device/export",{...i.value},`device_${new Date().getTime()}.xlsx`)}return g(),(d,a)=>{const s=r("el-option"),h=r("el-select"),p=r("el-form-item"),V=r("el-input"),f=r("el-button"),H=r("el-form"),N=r("el-col"),re=r("right-toolbar"),ce=r("el-row"),_=r("el-table-column"),J=r("dict-tag"),se=r("el-table"),ve=r("pagination"),W=r("el-date-picker"),me=r("el-dialog"),w=X("hasPermi"),fe=X("loading");return n(),I("div",Ce,[S(l(H,{model:t(i),ref:"queryRef",inline:!0,"label-width":"68px"},{default:o(()=>[l(p,{label:"\u8BBE\u5907\u72B6\u6001",prop:"deviceStatus"},{default:o(()=>[l(h,{modelValue:t(i).deviceStatus,"onUpdate:modelValue":a[0]||(a[0]=e=>t(i).deviceStatus=e),placeholder:"\u8BF7\u9009\u62E9\u8BBE\u5907\u72B6\u6001",clearable:""},{default:o(()=>[(n(!0),I(C,null,B(t(K),e=>(n(),c(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"\u7F16\u53F7",prop:"deviceCode"},{default:o(()=>[l(V,{modelValue:t(i).deviceCode,"onUpdate:modelValue":a[1]||(a[1]=e=>t(i).deviceCode=e),placeholder:"\u8BF7\u8F93\u5165\u7F16\u53F7",clearable:"",onKeyup:M(T,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(p,{label:"\u5165\u5E93\u4EBA",prop:"deviceInStockBy"},{default:o(()=>[l(V,{modelValue:t(i).deviceInStockBy,"onUpdate:modelValue":a[2]||(a[2]=e=>t(i).deviceInStockBy=e),placeholder:"\u8BF7\u8F93\u5165\u5165\u5E93\u4EBA",clearable:"",onKeyup:M(T,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(p,{label:"\u51FA\u5E93\u4EBA",prop:"deviceOutStockBy"},{default:o(()=>[l(V,{modelValue:t(i).deviceOutStockBy,"onUpdate:modelValue":a[3]||(a[3]=e=>t(i).deviceOutStockBy=e),placeholder:"\u8BF7\u8F93\u5165\u51FA\u5E93\u4EBA",clearable:"",onKeyup:M(T,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(p,{label:"\u72B6\u6001",prop:"stockStatus"},{default:o(()=>[l(h,{modelValue:t(i).stockStatus,"onUpdate:modelValue":a[4]||(a[4]=e=>t(i).stockStatus=e),placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",clearable:""},{default:o(()=>[(n(!0),I(C,null,B(t(R),e=>(n(),c(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,null,{default:o(()=>[l(f,{type:"primary",icon:"Search",onClick:T},{default:o(()=>[k("\u641C\u7D22")]),_:1}),l(f,{icon:"Refresh",onClick:ue},{default:o(()=>[k("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[Z,t(x)]]),l(ce,{gutter:10,class:"mb8"},{default:o(()=>[l(N,{span:1.5},{default:o(()=>[S((n(),c(f,{type:"primary",plain:"",icon:"Plus",onClick:ne},{default:o(()=>[k("\u65B0\u589E")]),_:1})),[[w,["app:device:add"]]])]),_:1},8,["span"]),l(N,{span:1.5},{default:o(()=>[S((n(),c(f,{type:"success",plain:"",icon:"Edit",disabled:t(Q),onClick:A},{default:o(()=>[k("\u4FEE\u6539")]),_:1},8,["disabled"])),[[w,["app:device:edit"]]])]),_:1},8,["span"]),l(N,{span:1.5},{default:o(()=>[S((n(),c(f,{type:"danger",plain:"",icon:"Delete",disabled:t(j),onClick:G},{default:o(()=>[k("\u5220\u9664")]),_:1},8,["disabled"])),[[w,["app:device:remove"]]])]),_:1},8,["span"]),l(N,{span:1.5},{default:o(()=>[S((n(),c(f,{type:"warning",plain:"",icon:"Download",onClick:pe},{default:o(()=>[k("\u5BFC\u51FA")]),_:1})),[[w,["app:device:export"]]])]),_:1},8,["span"]),l(re,{showSearch:t(x),"onUpdate:showSearch":a[5]||(a[5]=e=>ee(x)?x.value=e:null),onQueryTable:g},null,8,["showSearch"])]),_:1}),S((n(),c(se,{data:t(L),onSelectionChange:de},{default:o(()=>[l(_,{type:"selection",width:"55",align:"center"}),l(_,{label:"\u8BBE\u5907\u7F16\u53F7",align:"center",prop:"deviceCode"}),l(_,{label:"\u4EA7\u54C1\u578B\u53F7",align:"center",prop:"product.productName"}),l(_,{label:"\u8BBE\u5907\u6388\u6743",align:"center",prop:"deviceStatus"},{default:o(e=>[l(J,{options:t(K),value:e.row.deviceStatus},null,8,["options","value"])]),_:1}),l(_,{label:"\u5165\u5E93\u65F6\u95F4",align:"center",prop:"deviceInStockTime",width:"180"},{default:o(e=>[q("span",null,le(d.parseTime(e.row.deviceInStockTime,"{y}-{m}-{d}")),1)]),_:1}),l(_,{label:"\u5165\u5E93\u4EBA",align:"center",prop:"deviceInStockBy"}),l(_,{label:"\u51FA\u5E93\u65F6\u95F4",align:"center",prop:"deviceOutStockTime",width:"180"},{default:o(e=>[q("span",null,le(d.parseTime(e.row.deviceOutStockTime,"{y}-{m}-{d}")),1)]),_:1}),l(_,{label:"\u51FA\u5E93\u4EBA",align:"center",prop:"deviceOutStockBy"}),l(_,{label:"\u5B58\u8D27\u72B6\u6001",align:"center",prop:"stockStatus"},{default:o(e=>[l(J,{options:t(R),value:e.row.stockStatus},null,8,["options","value"])]),_:1}),l(_,{label:"\u64CD\u4F5C",align:"center","class-name":"small-padding fixed-width"},{default:o(e=>[S((n(),c(f,{link:"",type:"primary",icon:"Edit",onClick:_e=>A(e.row)},{default:o(()=>[k("\u4FEE\u6539")]),_:2},1032,["onClick"])),[[w,["app:device:edit"]]]),S((n(),c(f,{link:"",type:"primary",icon:"Delete",onClick:_e=>G(e.row)},{default:o(()=>[k("\u5220\u9664")]),_:2},1032,["onClick"])),[[w,["app:device:remove"]]])]),_:1})]),_:1},8,["data"])),[[fe,t(Y)]]),S(l(ve,{total:t(P),page:t(i).pageNum,"onUpdate:page":a[6]||(a[6]=e=>t(i).pageNum=e),limit:t(i).pageSize,"onUpdate:limit":a[7]||(a[7]=e=>t(i).pageSize=e),onPagination:g},null,8,["total","page","limit"]),[[Z,t(P)>0]]),l(me,{title:t(E),modelValue:t(y),"onUpdate:modelValue":a[18]||(a[18]=e=>ee(y)?y.value=e:null),width:"500px","append-to-body":""},{footer:o(()=>[q("div",Be,[l(f,{type:"primary",onClick:ie},{default:o(()=>[k("\u786E \u5B9A")]),_:1}),l(f,{onClick:oe},{default:o(()=>[k("\u53D6 \u6D88")]),_:1})])]),default:o(()=>[l(H,{ref:"deviceRef",model:t(u),rules:t(ae),"label-width":"80px"},{default:o(()=>[l(p,{label:"\u4EA7\u54C1\u578B\u53F7",prop:"supplierId"},{default:o(()=>[l(h,{modelValue:t(u).productId,"onUpdate:modelValue":a[8]||(a[8]=e=>t(u).productId=e),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u578B\u53F7"},{default:o(()=>[(n(!0),I(C,null,B(t(U),e=>(n(),c(s,{key:e.productId,label:e.productName,value:e.productId,disabled:e.status==1},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"\u4F9B\u5E94\u5546",prop:"supplierId"},{default:o(()=>[l(h,{modelValue:t(u).supplierId,"onUpdate:modelValue":a[9]||(a[9]=e=>t(u).supplierId=e),placeholder:"\u8BF7\u9009\u62E9"},{default:o(()=>[(n(!0),I(C,null,B(t(O),e=>(n(),c(s,{key:e.supplierId,label:e.supplierName,value:e.supplierId,disabled:e.status==1},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"\u8BBE\u5907\u6388\u6743",prop:"deviceStatus"},{default:o(()=>[l(h,{modelValue:t(u).deviceStatus,"onUpdate:modelValue":a[10]||(a[10]=e=>t(u).deviceStatus=e),placeholder:"\u8BF7\u9009\u62E9\u8BBE\u5907\u72B6\u6001"},{default:o(()=>[(n(!0),I(C,null,B(t(K),e=>(n(),c(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"\u8BBE\u5907\u7F16\u53F7",prop:"deviceCode"},{default:o(()=>[l(V,{modelValue:t(u).deviceCode,"onUpdate:modelValue":a[11]||(a[11]=e=>t(u).deviceCode=e),placeholder:"\u8BF7\u8F93\u5165\u8BBE\u5907\u7F16\u53F7"},null,8,["modelValue"])]),_:1}),l(p,{label:"\u5165\u5E93\u4EBA",prop:"deviceInStockBy"},{default:o(()=>[l(V,{modelValue:t(u).deviceInStockBy,"onUpdate:modelValue":a[12]||(a[12]=e=>t(u).deviceInStockBy=e),placeholder:"\u8BF7\u8F93\u5165\u5165\u5E93\u4EBA"},null,8,["modelValue"])]),_:1}),l(p,{label:"\u5165\u5E93\u65F6\u95F4",prop:"deviceInStockTime"},{default:o(()=>[l(W,{clearable:"",modelValue:t(u).deviceInStockTime,"onUpdate:modelValue":a[13]||(a[13]=e=>t(u).deviceInStockTime=e),type:"date","value-format":"YYYY-MM-DD",placeholder:"\u8BF7\u9009\u62E9\u5165\u5E93\u65F6\u95F4"},null,8,["modelValue"])]),_:1}),l(p,{label:"\u51FA\u5E93\u4EBA",prop:"deviceOutStockBy"},{default:o(()=>[l(V,{modelValue:t(u).deviceOutStockBy,"onUpdate:modelValue":a[14]||(a[14]=e=>t(u).deviceOutStockBy=e),placeholder:"\u8BF7\u8F93\u5165\u51FA\u5E93\u4EBA"},null,8,["modelValue"])]),_:1}),l(p,{label:"\u51FA\u5E93\u65F6\u95F4",prop:"deviceOutStockTime"},{default:o(()=>[l(W,{clearable:"",modelValue:t(u).deviceOutStockTime,"onUpdate:modelValue":a[15]||(a[15]=e=>t(u).deviceOutStockTime=e),type:"date","value-format":"YYYY-MM-DD",placeholder:"\u8BF7\u9009\u62E9\u51FA\u5E93\u65F6\u95F4"},null,8,["modelValue"])]),_:1}),l(p,{label:"\u72B6\u6001",prop:"stockStatus"},{default:o(()=>[l(h,{modelValue:t(u).stockStatus,"onUpdate:modelValue":a[16]||(a[16]=e=>t(u).stockStatus=e),placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001"},{default:o(()=>[(n(!0),I(C,null,B(t(R),e=>(n(),c(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"\u5907\u6CE8",prop:"remark"},{default:o(()=>[l(V,{modelValue:t(u).remark,"onUpdate:modelValue":a[17]||(a[17]=e=>t(u).remark=e),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Oe as default};
