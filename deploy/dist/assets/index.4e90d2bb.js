import{A as k,z as ie,r as b,B as re,C as pe,d as s,D as T,o as y,c as se,F as U,G as q,f as t,e,w as n,i as S,m as v,j as w,H as z,k as x,x as F,s as me}from"./index.75c81e14.js";function ce(m){return k({url:"/app/licenses/list",method:"get",params:m})}function fe(m){return k({url:"/app/licenses/"+m,method:"get"})}function be(m){return k({url:"/app/licenses",method:"post",data:m})}function ve(m){return k({url:"/app/licenses",method:"put",data:m})}function ge(m,i){return k({url:"/app/licenses/changeStatus",method:"put",data:{licenseId:m,used:i}})}function _e(m,i){return k({url:"/app/licenses/changeStatus",method:"put",data:{licenseId:m,enabled:i}})}const Ve={class:"app-container"},ye={class:"dialog-footer"},he=ie({name:"Licenses"}),Se=Object.assign(he,{setup(m){const{proxy:i}=me();i.useDict("license_used"),i.useDict("license_enabled");const j=b([]),g=b(!1),D=b(!0),C=b(!0),$=b([]),L=b(!0),Q=b(!0),E=b(0),M=b(""),A=re({form:{},queryParams:{pageNum:1,pageSize:10,deviceId:null,used:null,enabled:null,limitStart:null,limitEnd:null},rules:{}}),{queryParams:d,form:u,rules:G}=pe(A);function h(){D.value=!0,ce(d.value).then(o=>{j.value=o.rows,E.value=o.total,D.value=!1})}function H(){g.value=!1,N()}function N(){u.value={licenseId:null,deviceId:null,used:null,enabled:null,limitStart:null,limitEnd:null,createBy:null,createTime:null,updateBy:null,updateTime:null,remark:null},i.resetForm("licensesRef")}function _(){d.value.pageNum=1,h()}function O(){i.resetForm("queryRef"),_()}function J(o){$.value=o.map(a=>a.licenseId),L.value=o.length!=1,Q.value=!o.length}function W(){N(),g.value=!0,u.value.used="0",u.value.enabled="0",M.value="\u6DFB\u52A0\u6388\u6743\u7BA1\u7406"}function R(o){N();const a=o.id||$.value;fe(a).then(p=>{u.value=p.data,g.value=!0,M.value="\u4FEE\u6539\u6388\u6743\u7BA1\u7406"})}function X(){i.$refs.licensesRef.validate(o=>{o&&(u.value.id!=null?ve(u.value).then(a=>{i.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),g.value=!1,h()}):be(u.value).then(a=>{i.$modal.msgSuccess("\u65B0\u589E\u6210\u529F"),g.value=!1,h()}))})}function Z(o){i.download("app/licenses/file/download/"+o.licenseId,{...d.value},`licenses_${o.fileName}.txt`)}function ee(o){let a=o.used==="0"?"\u542F\u7528":"\u505C\u7528";i.$modal.confirm('\u786E\u8BA4\u8981"'+a+'""'+o.deviceId+'"\u8BBE\u5907?').then(function(){return ge(o.licenseId,o.used)}).then(()=>{i.$modal.msgSuccess(a+"\u6210\u529F")}).catch(function(){o.used=o.used==="0"?"1":"0"})}function le(o){let a=o.enabled==="0"?"\u5BA1\u6838":"\u53CD\u5BA1";i.$modal.confirm('\u786E\u8BA4\u8981"'+a+'""'+o.deviceId+'"\u8BBE\u5907?').then(function(){return _e(o.licenseId,o.enabled)}).then(()=>{i.$modal.msgSuccess(a+"\u6210\u529F")}).catch(function(){o.enabled=o.enabled==="0"?"1":"0"})}return h(),(o,a)=>{const p=s("el-input"),r=s("el-form-item"),I=s("el-date-picker"),f=s("el-button"),B=s("el-form"),Y=s("el-col"),ae=s("right-toolbar"),te=s("el-row"),c=s("el-table-column"),P=s("el-switch"),ne=s("el-table"),oe=s("pagination"),de=s("el-dialog"),K=T("hasPermi"),ue=T("loading");return y(),se("div",Ve,[U(e(B,{model:t(d),ref:"queryRef",inline:!0,"label-width":"68px"},{default:n(()=>[e(r,{label:"\u8BBE\u5907id",prop:"deviceId"},{default:n(()=>[e(p,{modelValue:t(d).deviceId,"onUpdate:modelValue":a[0]||(a[0]=l=>t(d).deviceId=l),placeholder:"\u8BF7\u8F93\u5165\u8BBE\u5907id",clearable:"",onKeyup:S(_,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(r,{label:"\u662F\u5426\u4F7F\u7528",prop:"used"},{default:n(()=>[e(p,{modelValue:t(d).used,"onUpdate:modelValue":a[1]||(a[1]=l=>t(d).used=l),placeholder:"\u8BF7\u8F93\u5165\u662F\u5426\u4F7F\u7528",clearable:"",onKeyup:S(_,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(r,{label:"\u72B6\u6001",prop:"enabled"},{default:n(()=>[e(p,{modelValue:t(d).enabled,"onUpdate:modelValue":a[2]||(a[2]=l=>t(d).enabled=l),placeholder:"\u8BF7\u8F93\u5165\u72B6\u6001",clearable:"",onKeyup:S(_,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(r,{label:"\u66F4\u65B0\u65F6\u95F4",prop:"limitStart"},{default:n(()=>[e(I,{clearable:"",modelValue:t(d).limitStart,"onUpdate:modelValue":a[3]||(a[3]=l=>t(d).limitStart=l),type:"date","value-format":"YYYY-MM-DD",placeholder:"\u8BF7\u9009\u62E9\u66F4\u65B0\u65F6\u95F4"},null,8,["modelValue"])]),_:1}),e(r,{label:"\u66F4\u65B0\u65F6\u95F4",prop:"limitEnd"},{default:n(()=>[e(I,{clearable:"",modelValue:t(d).limitEnd,"onUpdate:modelValue":a[4]||(a[4]=l=>t(d).limitEnd=l),type:"date","value-format":"YYYY-MM-DD",placeholder:"\u8BF7\u9009\u62E9\u66F4\u65B0\u65F6\u95F4"},null,8,["modelValue"])]),_:1}),e(r,{label:"\u9879\u76EE\u540D\u79F0",prop:"projectName"},{default:n(()=>[e(p,{modelValue:t(d).projectName,"onUpdate:modelValue":a[5]||(a[5]=l=>t(d).projectName=l),placeholder:"\u8BF7\u8F93\u5165\u9879\u76EE\u540D\u79F0",clearable:"",onKeyup:S(_,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(r,{label:"\u8054\u7CFB\u4EBA\u59D3\u540D",prop:"projectUsername"},{default:n(()=>[e(p,{modelValue:t(d).projectUsername,"onUpdate:modelValue":a[6]||(a[6]=l=>t(d).projectUsername=l),placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u4EBA\u59D3\u540D",clearable:"",onKeyup:S(_,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(r,{label:"\u8054\u7CFB\u4EBA\u7535\u8BDD",prop:"projectMobile"},{default:n(()=>[e(p,{modelValue:t(d).projectMobile,"onUpdate:modelValue":a[7]||(a[7]=l=>t(d).projectMobile=l),placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u4EBA\u7535\u8BDD",clearable:"",onKeyup:S(_,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(r,null,{default:n(()=>[e(f,{type:"primary",icon:"Search",onClick:_},{default:n(()=>[v("\u641C\u7D22")]),_:1}),e(f,{icon:"Refresh",onClick:O},{default:n(()=>[v("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[q,t(C)]]),e(te,{gutter:10,class:"mb8"},{default:n(()=>[e(Y,{span:1.5},{default:n(()=>[U((y(),w(f,{type:"primary",plain:"",icon:"Plus",onClick:W},{default:n(()=>[v("\u65B0\u589E")]),_:1})),[[K,["app:licenses:add"]]])]),_:1},8,["span"]),e(Y,{span:1.5},{default:n(()=>[U((y(),w(f,{type:"success",plain:"",icon:"Edit",disabled:t(L),onClick:R},{default:n(()=>[v("\u4FEE\u6539")]),_:1},8,["disabled"])),[[K,["app:licenses:edit"]]])]),_:1},8,["span"]),e(Y,{span:1.5},null,8,["span"]),e(Y,{span:1.5},null,8,["span"]),e(ae,{showSearch:t(C),"onUpdate:showSearch":a[8]||(a[8]=l=>z(C)?C.value=l:null),onQueryTable:h},null,8,["showSearch"])]),_:1}),U((y(),w(ne,{data:t(j),onSelectionChange:J},{default:n(()=>[e(c,{type:"selection",width:"55",align:"center"}),e(c,{label:"License Id",align:"center",prop:"licenseId"}),e(c,{label:"\u8BBE\u5907Id",align:"center",prop:"deviceId"}),e(c,{label:"\u662F\u5426\u4F7F\u7528",align:"center"},{default:n(l=>[e(P,{modelValue:l.row.used,"onUpdate:modelValue":V=>l.row.used=V,"active-value":"1","inactive-value":"0",onChange:V=>ee(l.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(c,{label:"\u662F\u5426\u5BA1\u6838",align:"center"},{default:n(l=>[e(P,{modelValue:l.row.enabled,"onUpdate:modelValue":V=>l.row.enabled=V,"active-value":"1","inactive-value":"0",onChange:V=>le(l.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(c,{label:"\u9879\u76EE\u540D\u79F0",align:"center",prop:"projectName"}),e(c,{label:"\u8054\u7CFB\u4EBA\u59D3\u540D",align:"center",prop:"projectUsername"}),e(c,{label:"\u8054\u7CFB\u4EBA\u7535\u8BDD",align:"center",prop:"projectMobile"}),e(c,{label:"\u5F00\u59CB\u65F6\u95F4",align:"center",prop:"limitStart",width:"180"},{default:n(l=>[x("span",null,F(o.parseTime(l.row.limitStart,"{y}-{m}-{d}")),1)]),_:1}),e(c,{label:"\u622A\u81F3\u65F6\u95F4",align:"center",prop:"limitEnd",width:"180"},{default:n(l=>[x("span",null,F(o.parseTime(l.row.limitEnd,"{y}-{m}-{d}")),1)]),_:1}),e(c,{label:"\u4E0B\u8F7D",align:"center",prop:"limitStart",width:"180"},{default:n(l=>[l.row.enabled==1?(y(),w(f,{key:0,link:"",type:"primary",icon:"Download",onClick:V=>Z(l.row)},{default:n(()=>[v("\u4E0B\u8F7D")]),_:2},1032,["onClick"])):(y(),w(f,{key:1},{default:n(()=>[v("\u5BA1\u6838\u540E\u4E0B\u8F7D")]),_:1}))]),_:1}),e(c,{label:"\u64CD\u4F5C",align:"center","class-name":"small-padding fixed-width"},{default:n(l=>[U((y(),w(f,{link:"",type:"primary",icon:"Edit",onClick:V=>R(l.row)},{default:n(()=>[v("\u4FEE\u6539")]),_:2},1032,["onClick"])),[[K,["app:licenses:edit"]]])]),_:1})]),_:1},8,["data"])),[[ue,t(D)]]),U(e(oe,{total:t(E),page:t(d).pageNum,"onUpdate:page":a[9]||(a[9]=l=>t(d).pageNum=l),limit:t(d).pageSize,"onUpdate:limit":a[10]||(a[10]=l=>t(d).pageSize=l),onPagination:h},null,8,["total","page","limit"]),[[q,t(E)>0]]),e(de,{title:t(M),modelValue:t(g),"onUpdate:modelValue":a[18]||(a[18]=l=>z(g)?g.value=l:null),width:"500px","append-to-body":""},{footer:n(()=>[x("div",ye,[e(f,{type:"primary",onClick:X},{default:n(()=>[v("\u786E \u5B9A")]),_:1}),e(f,{onClick:H},{default:n(()=>[v("\u53D6 \u6D88")]),_:1})])]),default:n(()=>[e(B,{ref:"licensesRef",model:t(u),rules:t(G),"label-width":"80px"},{default:n(()=>[e(r,{label:"\u8BBE\u5907Id",prop:"deviceId"},{default:n(()=>[e(p,{modelValue:t(u).deviceId,"onUpdate:modelValue":a[11]||(a[11]=l=>t(u).deviceId=l),placeholder:"\u8BF7\u8F93\u5165\u8BBE\u5907Id"},null,8,["modelValue"])]),_:1}),e(r,{label:"\u9879\u76EE\u540D\u79F0",prop:"projectName"},{default:n(()=>[e(p,{modelValue:t(u).projectName,"onUpdate:modelValue":a[12]||(a[12]=l=>t(u).projectName=l),placeholder:"\u8BF7\u8F93\u5165\u9879\u76EE\u540D\u79F0"},null,8,["modelValue"])]),_:1}),e(r,{label:"\u8054\u7CFB\u4EBA\u59D3\u540D",prop:"projectUsername"},{default:n(()=>[e(p,{modelValue:t(u).projectUsername,"onUpdate:modelValue":a[13]||(a[13]=l=>t(u).projectUsername=l),placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u4EBA\u59D3\u540D"},null,8,["modelValue"])]),_:1}),e(r,{label:"\u8054\u7CFB\u4EBA\u7535\u8BDD",prop:"projectMobile"},{default:n(()=>[e(p,{modelValue:t(u).projectMobile,"onUpdate:modelValue":a[14]||(a[14]=l=>t(u).projectMobile=l),placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u4EBA\u7535\u8BDD"},null,8,["modelValue"])]),_:1}),e(r,{label:"\u66F4\u65B0\u65F6\u95F4",prop:"limitStart"},{default:n(()=>[e(I,{clearable:"",modelValue:t(u).limitStart,"onUpdate:modelValue":a[15]||(a[15]=l=>t(u).limitStart=l),type:"date","value-format":"YYYY-MM-DD",placeholder:"\u8BF7\u9009\u62E9\u66F4\u65B0\u65F6\u95F4"},null,8,["modelValue"])]),_:1}),e(r,{label:"\u66F4\u65B0\u65F6\u95F4",prop:"limitEnd"},{default:n(()=>[e(I,{clearable:"",modelValue:t(u).limitEnd,"onUpdate:modelValue":a[16]||(a[16]=l=>t(u).limitEnd=l),type:"date","value-format":"YYYY-MM-DD",placeholder:"\u8BF7\u9009\u62E9\u66F4\u65B0\u65F6\u95F4"},null,8,["modelValue"])]),_:1}),e(r,{label:"\u5907\u6CE8",prop:"remark"},{default:n(()=>[e(p,{modelValue:t(u).remark,"onUpdate:modelValue":a[17]||(a[17]=l=>t(u).remark=l),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Se as default};
